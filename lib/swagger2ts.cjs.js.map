{"version":3,"file":"swagger2ts.cjs.js","sources":["../src/helper/transformType.ts","../src/core/parse.ts","../src/helper/logger.ts","../src/core/config.ts","../src/core/gen.ts","../src/index.ts"],"sourcesContent":["export const transformType = (type: string) => {\n  let res = ''\n  switch (type) {\n    case 'integer':\n      res = 'number'\n      break\n\n    default:\n      res = type\n      break\n  }\n\n  return res\n}\n","import { transformType } from '../helper/transformType'\n\nimport type { SwaggerJson, SwaggerPath, SwaggerDefinitions } from '../type/SwaggerJson'\n\nconst transformParameters = (rowParameters: any[]) => {\n  let res = ''\n  rowParameters.forEach((parameter) => {\n    const { name, description, required, type: rowType, schema } = parameter\n\n    const type = rowType\n      ? {\n      }\n      : {\n          is$ref: true,\n          type: schema?.$ref?.replace('#/definitions/', '')\n        }\n\n    const isArray = type === 'array'\n\n    res += `\\n${description ? '/** ' + description + ' */' : ''}\\n${name}${\n      required ? '' : '?'\n    }: ${transformType(type)}${isArray ? '[]' : ''}, \\n`\n  })\n\n  return res\n}\n\nconst transformResponses = (responses: any) => {\n  const succResponses = responses['200']\n  const { $ref, type } = succResponses.schema\n  if ($ref) {\n    return $ref.replace('#/definitions/', '')\n  } else {\n    return transformType(type)\n  }\n}\n\nconst transformPaths = (paths: SwaggerPath) => {\n  const res: any[] = []\n  for (const path in paths) {\n    const pathItem = paths[path]\n\n    Object.keys(pathItem).forEach((method) => {\n      const { operationId, produces, parameters: rowParameters, responses } = pathItem[method]\n\n      const parameters = transformParameters(rowParameters)\n      const response = transformResponses(responses)\n\n      res.push({\n        method,\n        apiName: operationId,\n        produces,\n        parameters,\n        response\n      })\n    })\n  }\n  return res\n}\n\nconst transformDefinitions = (definitions: SwaggerDefinitions) => {\n  const res: any[] = []\n  console.log('definitions: ', definitions)\n  return res\n}\n\nexport const parseSwagger = (swaggerJsonStr: string) => {\n  const swaggerJson: SwaggerJson = JSON.parse(swaggerJsonStr)\n  const { swagger, info, paths, definitions } = swaggerJson\n  const swaggerInfo = {\n    swaggerVersion: swagger,\n    info\n  }\n\n  const pathsResult = transformPaths(paths)\n  const interfaces = transformDefinitions(definitions)\n\n  return {\n    swaggerInfo,\n    pathsResult,\n    interfaces\n  }\n}\n","/* eslint no-console: 0 */\n\nimport colors from 'picocolors'\nimport type { RollupError } from 'rollup'\n\nexport type LogType = 'error' | 'warn' | 'info'\nexport type LogLevel = LogType | 'silent'\nexport interface Logger {\n  info(msg: string, options?: LogOptions): void\n  warn(msg: string, options?: LogOptions): void\n  warnOnce(msg: string, options?: LogOptions): void\n  error(msg: string, options?: LogErrorOptions): void\n}\n\nexport interface LogOptions {\n  clear?: boolean\n  timestamp?: boolean\n}\n\nexport interface LogErrorOptions extends LogOptions {\n  error?: Error | RollupError | null\n}\n\nconst output = (type: LogType, msg: string) => {\n  const prefix = 'swagger2ts'\n\n  /* eslint no-nested-ternary: 0 */\n  const tag =\n    type === 'info'\n      ? colors.cyan(colors.bold(prefix))\n      : type === 'warn'\n      ? colors.yellow(colors.bold(prefix))\n      : colors.red(colors.bold(prefix))\n\n  console[type](\n    `${colors.bgWhite(colors.bold(new Date().toLocaleTimeString()))} : ${tag}  ` + '\\n\\t' + `${msg}`\n  )\n}\n\nexport function createLogger(): Logger {\n  const warnedMessages = new Set<string>()\n\n  const logger: Logger = {\n    info(msg) {\n      output('info', msg)\n    },\n    warn(msg) {\n      output('warn', msg)\n    },\n    warnOnce(msg) {\n      if (warnedMessages.has(msg)) return\n      output('warn', msg)\n      warnedMessages.add(msg)\n    },\n    error(msg) {\n      output('error', msg)\n    }\n  }\n\n  return logger\n}\n","import { readFileSync } from 'node:fs'\nimport { parseSwagger } from './parse'\n\nimport { createLogger } from '../helper/logger'\n\nexport type Swagger2TsOptions = {\n  name: string\n  httpClientType: 'axios'\n  input?: string\n  url?: string\n  output: string\n}\n\nconst logger = createLogger()\n\nexport type ResolvedConfig = any\n\nexport const resolveOptions: (options: Swagger2TsOptions) => Promise<ResolvedConfig> = async (\n  options\n) => {\n  const { name, output, httpClientType, input, url } = options\n\n  if (!input && !url) {\n    logger.error('You must provide either an input file or a url')\n    process.exit(1)\n  }\n\n  let swaggerJson: any = null\n\n  if (input) {\n    swaggerJson = readFileSync(input, 'utf8')\n    if (!swaggerJson) {\n      logger.error(`Could not read file in this path : ${input}`)\n      process.exit(1)\n    }\n  }\n\n  const res = await parseSwagger(swaggerJson)\n\n  const resolved: ResolvedConfig = {\n    name,\n    ...res,\n    output,\n    httpClientType,\n    input,\n    url\n  }\n\n  return resolved\n}\n","import ejs from 'ejs'\nimport { resolve } from 'node:path'\nimport { readFileSync, writeFileSync } from 'node:fs'\nimport type { ResolvedConfig } from './config'\n\nexport const genCode = async (resolvedConfig: ResolvedConfig) => {\n  const { pathsResult } = resolvedConfig\n\n  const template = readFileSync(resolve(__dirname, '../templates/api.ejs'), 'utf-8')\n  try {\n    const buffer = ejs.render(template, {\n      pathsResult,\n      interfaces: []\n    })\n    const { name } = resolvedConfig\n\n    await writeFileSync(`${name}`, buffer)\n  } catch (e) {\n    console.log(e)\n  }\n}\n","import { resolveOptions, genCode } from './core'\nimport type { Swagger2TsOptions } from './core'\n\nexport const swagger2ts = async (options: Swagger2TsOptions) => {\n  const resolvedOptions = await resolveOptions(options)\n  await genCode(resolvedOptions)\n}\n"],"names":["colors","readFileSync","resolve","ejs","writeFileSync"],"mappings":"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"}